{% extends "base.html" %}
{% from "_icons.html" import icon %}

{% block title %}Invitation Sent - Lucky Ledger{% endblock %}

{% block content %}
<div class="max-w-lg mx-auto animate-fade-in">
    <div class="bg-white rounded-3xl shadow-lg border border-warm-200 p-8 text-center relative overflow-hidden">
        <!-- Decorative corners -->
        <div class="absolute top-0 right-0 w-32 h-32 bg-gradient-to-bl from-sage-100 to-transparent rounded-bl-full opacity-50"></div>
        <div class="absolute bottom-0 left-0 w-24 h-24 bg-gradient-to-tr from-terracotta-100 to-transparent rounded-tr-full opacity-40"></div>

        <!-- Success illustration - flying envelope with hearts -->
        <div class="flex justify-center mb-6 relative">
            <svg class="w-28 h-28 text-sage-400" viewBox="0 0 100 100" fill="none">
                <!-- Envelope flying -->
                <rect x="20" y="35" width="60" height="40" rx="4" stroke="currentColor" stroke-width="3" fill="none" transform="rotate(-5 50 55)"/>
                <path d="M22 40L50 58L78 40" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" transform="rotate(-5 50 55)"/>
                <!-- Motion lines -->
                <path d="M10 50L5 50" stroke="currentColor" stroke-width="2" stroke-linecap="round" opacity="0.5"/>
                <path d="M12 58L6 60" stroke="currentColor" stroke-width="2" stroke-linecap="round" opacity="0.4"/>
                <path d="M12 42L6 40" stroke="currentColor" stroke-width="2" stroke-linecap="round" opacity="0.4"/>
                <!-- Hearts -->
                <path d="M75 20C75 16 70 13 67 17C65 20 65 26 75 32C85 26 85 20 83 17C80 13 75 16 75 20Z" fill="currentColor" opacity="0.4" class="animate-bounce-gentle"/>
                <path d="M88 35C88 33 86 32 85 33C84.5 34 84.5 36 88 38C91.5 36 91.5 34 91 33C90 32 88 33 88 35Z" fill="currentColor" opacity="0.3"/>
                <path d="M65 12C65 10 63 9 62 10C61.5 11 61.5 13 65 15C68.5 13 68.5 11 68 10C67 9 65 10 65 12Z" fill="currentColor" opacity="0.35"/>
                <!-- Sparkles -->
                <circle cx="90" cy="25" r="2" fill="currentColor" opacity="0.5"/>
                <circle cx="60" cy="8" r="1.5" fill="currentColor" opacity="0.4"/>
            </svg>
        </div>

        <h2 class="text-2xl font-bold font-display text-warm-800 mb-2 flex items-center justify-center gap-2">
            {{ icon('cat-celebrate', size='lg') }}
            <span>Invitation Sent!</span>
        </h2>

        {% if email_sent %}
            <p class="text-warm-600 mb-6">
                We've sent an invitation to <strong class="text-terracotta-600">{{ email }}</strong>.
                <br>They can click the link to join your household!
            </p>
        {% else %}
            <p class="text-warm-600 mb-4">
                Share this invitation link with <strong class="text-terracotta-600">{{ email }}</strong>:
            </p>
            <div class="bg-cream-50 rounded-2xl p-4 mb-6 border border-warm-200">
                <input
                    type="text"
                    readonly
                    value="{{ invite_url }}"
                    id="invite-link"
                    class="w-full px-3 py-2.5 bg-white border-2 border-warm-200 rounded-xl text-sm font-mono text-warm-700"
                >
                <button
                    onclick="copyInviteLink()"
                    class="mt-3 text-sm text-terracotta-600 hover:text-terracotta-700 font-semibold transition-colors flex items-center justify-center gap-1 mx-auto"
                >
                    {{ icon('cat-clipboard', size='sm') }}
                    <span>Copy to clipboard</span>
                </button>
            </div>
        {% endif %}

        <div class="bg-terracotta-50 rounded-2xl p-5 mb-6 text-left border border-terracotta-100">
            <h3 class="font-semibold text-terracotta-700 mb-3 flex items-center gap-2">
                {{ icon('cat-sparkle', size='md') }}
                <span>What happens next?</span>
            </h3>
            <ul class="text-sm text-terracotta-600 space-y-2">
                <li class="flex items-start gap-2">
                    <span>1Ô∏è‚É£</span>
                    <span>Your partner receives the invitation</span>
                </li>
                <li class="flex items-start gap-2">
                    <span>2Ô∏è‚É£</span>
                    <span>They click the link and sign up (or log in)</span>
                </li>
                <li class="flex items-start gap-2">
                    <span>3Ô∏è‚É£</span>
                    <span>They automatically join your household</span>
                </li>
                <li class="flex items-start gap-2">
                    <span>4Ô∏è‚É£</span>
                    <span>Start tracking expenses together!</span>
                </li>
            </ul>
        </div>

        <p class="text-sm text-warm-400 mb-6 flex items-center justify-center gap-1">
            {{ icon('cat-clock', size='sm') }}
            <span>The invitation expires in 7 days</span>
        </p>

        <div class="flex gap-4 justify-center">
            <a
                href="{{ url_for('invitations.send_invitation') }}"
                class="px-5 py-2.5 border-2 border-warm-200 text-warm-600 hover:border-terracotta-300 hover:text-terracotta-600 rounded-xl font-semibold transition-all duration-200"
            >
                Send Another
            </a>
            <a
                href="/"
                class="px-5 py-2.5 bg-terracotta-500 hover:bg-terracotta-600 text-white rounded-xl font-semibold transition-all duration-200"
            >
                Back to Transactions
            </a>
        </div>
    </div>
</div>

<script>
function copyInviteLink() {
    const linkInput = document.getElementById('invite-link');
    linkInput.select();
    navigator.clipboard.writeText(linkInput.value).then(() => {
        alert('Link copied to clipboard! üìã');
    }).catch(() => {
        document.execCommand('copy');
        alert('Link copied to clipboard! üìã');
    });
}
</script>
{% endblock %}
